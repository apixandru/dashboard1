(window.webpackJsonp=window.webpackJsonp||[]).push([[16],{"+P1L":function(e,t,n){"use strict";n.r(t);var r=n("3Pt+"),o=n("RS3s"),i=n("vTDv"),s=n("tyNb"),a=n("fXoL");let l=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=a["\u0275\u0275defineComponent"]({type:e,selectors:[["ngx-users"]],decls:1,vars:0,template:function(e,t){1&e&&a["\u0275\u0275element"](0,"router-outlet")},directives:[s.h],encapsulation:2}),e})();var c=n("HDdC"),u=n("XNiG"),d=n("1G5W"),h=n("2NI8"),m=n("Cgdg"),g=n("McNs"),p=n("dwCd"),b=n("aceb"),f=n("6edl"),M=function(e){return e.VIEW="View",e.EDIT="Edit",e.ADD="Add",e.EDIT_SELF="EditSelf",e}({});let w=(()=>{class e{constructor(e,t,n,r,o,i,s){this.usersService=e,this.router=t,this.route=n,this.tokenService=r,this.userStore=o,this.toasterService=i,this.fb=s,this.unsubscribe$=new u.a}get login(){return this.userForm.get("login")}get email(){return this.userForm.get("email")}setViewMode(e){this.mode=e}ngOnInit(){this.initUserForm(),this.loadUserData()}initUserForm(){this.userForm=this.fb.group({id:this.fb.control(""),role:this.fb.control(""),login:this.fb.control("",[r.x.required,r.x.minLength(6),r.x.maxLength(20)]),email:this.fb.control("",[r.x.required,r.x.pattern(m.a)])})}get canEdit(){return this.mode!==M.VIEW}loadUserData(){const e=this.route.snapshot.paramMap.get("id");if(this.route.snapshot.queryParamMap.get("profile"))this.setViewMode(M.EDIT_SELF),this.loadUser();else if(e){const t=this.userStore.getUser().id;this.setViewMode(t.toString()===e?M.EDIT_SELF:M.EDIT),this.loadUser(e)}else this.setViewMode(M.ADD)}loadUser(e){(this.mode===M.EDIT_SELF?this.usersService.getCurrentUser():this.usersService.get(e)).pipe(Object(d.a)(this.unsubscribe$)).subscribe(e=>{this.userForm.setValue({id:e.id?e.id:"",role:e.role?e.role:"",login:e.login?e.login:"",email:e.email})})}convertToUser(e){return e}save(){const e=this.convertToUser(this.userForm.value);this.mode===M.EDIT_SELF&&this.usersService.updateCurrent(e).subscribe(e=>{this.tokenService.set(new g.f(e,"email",new Date)),this.handleSuccessResponse()},e=>{this.handleWrongResponse()}),(new c.a).pipe(Object(d.a)(this.unsubscribe$)).subscribe(()=>this.handleSuccessResponse(),e=>this.handleWrongResponse())}handleSuccessResponse(){this.toasterService.success("",`Item ${this.mode===M.ADD?"created":"updated"}!`),this.back()}handleWrongResponse(){this.toasterService.danger("","This email has already taken!")}back(){this.router.navigate(["/pages"])}ngOnDestroy(){this.unsubscribe$.next(),this.unsubscribe$.complete()}}return e.\u0275fac=function(t){return new(t||e)(a["\u0275\u0275directiveInject"](h.a),a["\u0275\u0275directiveInject"](s.c),a["\u0275\u0275directiveInject"](s.a),a["\u0275\u0275directiveInject"](g.k),a["\u0275\u0275directiveInject"](p.a),a["\u0275\u0275directiveInject"](b.dc),a["\u0275\u0275directiveInject"](r.c))},e.\u0275cmp=a["\u0275\u0275defineComponent"]({type:e,selectors:[["ngx-user"]],decls:20,vars:10,consts:[[1,"container",3,"formGroup"],[1,"form-group"],["for","inputLogin"],["nbInput","","id","inputLogin","formControlName","login","placeholder","Login",1,"form-control",3,"status"],["label","Login","minLength","6","maxLength","20",3,"showMinLength","showMaxLength","showRequired"],["for","inputEmail"],["nbInput","","id","inputEmail","formControlName","email","placeholder","Email",1,"form-control",3,"status"],["label","Email","min","1","max","120",3,"showPattern","showRequired"],["nbButton","","status","primary","hero","",3,"disabled","click"],["nbButton","","status","info","hero","",3,"click"]],template:function(e,t){1&e&&(a["\u0275\u0275elementStart"](0,"nb-card"),a["\u0275\u0275elementStart"](1,"nb-card-header"),a["\u0275\u0275text"](2),a["\u0275\u0275elementEnd"](),a["\u0275\u0275elementStart"](3,"nb-card-body"),a["\u0275\u0275elementStart"](4,"div",0),a["\u0275\u0275elementStart"](5,"div",1),a["\u0275\u0275elementStart"](6,"label",2),a["\u0275\u0275text"](7,"Login"),a["\u0275\u0275elementEnd"](),a["\u0275\u0275element"](8,"input",3),a["\u0275\u0275element"](9,"ngx-validation-message",4),a["\u0275\u0275elementEnd"](),a["\u0275\u0275elementStart"](10,"div",1),a["\u0275\u0275elementStart"](11,"label",5),a["\u0275\u0275text"](12,"Email"),a["\u0275\u0275elementEnd"](),a["\u0275\u0275element"](13,"input",6),a["\u0275\u0275element"](14,"ngx-validation-message",7),a["\u0275\u0275elementEnd"](),a["\u0275\u0275elementEnd"](),a["\u0275\u0275elementEnd"](),a["\u0275\u0275elementStart"](15,"nb-card-footer"),a["\u0275\u0275elementStart"](16,"button",8),a["\u0275\u0275listener"]("click",(function(){return t.save()})),a["\u0275\u0275text"](17,"Submit"),a["\u0275\u0275elementEnd"](),a["\u0275\u0275elementStart"](18,"button",9),a["\u0275\u0275listener"]("click",(function(){return t.back()})),a["\u0275\u0275text"](19,"Back"),a["\u0275\u0275elementEnd"](),a["\u0275\u0275elementEnd"](),a["\u0275\u0275elementEnd"]()),2&e&&(a["\u0275\u0275advance"](2),a["\u0275\u0275textInterpolate1"]("",t.mode," user"),a["\u0275\u0275advance"](2),a["\u0275\u0275property"]("formGroup",t.userForm),a["\u0275\u0275advance"](4),a["\u0275\u0275property"]("status",(null!=t.login&&null!=t.login.errors&&t.login.errors.required||null!=t.login&&t.login.hasError("minlength")||null!=t.login&&t.login.hasError("maxlength"))&&t.login.touched?"danger":"primary"),a["\u0275\u0275advance"](1),a["\u0275\u0275property"]("showMinLength",null==t.login?null:t.login.hasError("minlength"))("showMaxLength",null==t.login?null:t.login.hasError("maxlength"))("showRequired",(null==t.login?null:null==t.login.errors?null:t.login.errors.required)&&t.login.touched),a["\u0275\u0275advance"](4),a["\u0275\u0275property"]("status",(null!=t.email&&null!=t.email.errors&&t.email.errors.required||null!=t.email&&t.email.hasError("pattern"))&&t.email.touched?"danger":"primary"),a["\u0275\u0275advance"](1),a["\u0275\u0275property"]("showPattern",(null==t.email?null:t.email.hasError("pattern"))&&t.email.touched)("showRequired",(null==t.email?null:null==t.email.errors?null:t.email.errors.required)&&t.email.touched),a["\u0275\u0275advance"](2),a["\u0275\u0275property"]("disabled",!t.userForm.valid))},directives:[b.z,b.C,b.y,r.o,r.g,b.bb,r.b,r.n,r.f,f.a,b.A,b.m],styles:[".nb-theme-default   [_nghost-%COMP%]   button[nbButton][_ngcontent-%COMP%]{margin:.25rem}.nb-theme-default   [_nghost-%COMP%]   .container[_ngcontent-%COMP%]{display:-webkit-box;display:flex;flex-wrap:wrap;justify-content:space-around}.nb-theme-default   [_nghost-%COMP%]   input[_ngcontent-%COMP%]{width:20rem}[dir=ltr]   .nb-theme-default   [_nghost-%COMP%]   -shadowcsshost   button[_ngcontent-%COMP%]{margin:0 .75rem 0 0}[dir=rtl]   .nb-theme-default   [_nghost-%COMP%]   -shadowcsshost   button[_ngcontent-%COMP%]{margin:0 0 0 .75rem}.nb-theme-dark   [_nghost-%COMP%]   button[nbButton][_ngcontent-%COMP%]{margin:.25rem}.nb-theme-dark   [_nghost-%COMP%]   .container[_ngcontent-%COMP%]{display:-webkit-box;display:flex;flex-wrap:wrap;justify-content:space-around}.nb-theme-dark   [_nghost-%COMP%]   input[_ngcontent-%COMP%]{width:20rem}[dir=ltr]   .nb-theme-dark   [_nghost-%COMP%]   -shadowcsshost   button[_ngcontent-%COMP%]{margin:0 .75rem 0 0}[dir=rtl]   .nb-theme-dark   [_nghost-%COMP%]   -shadowcsshost   button[_ngcontent-%COMP%]{margin:0 0 0 .75rem}.nb-theme-cosmic   [_nghost-%COMP%]   button[nbButton][_ngcontent-%COMP%]{margin:.25rem}.nb-theme-cosmic   [_nghost-%COMP%]   .container[_ngcontent-%COMP%]{display:-webkit-box;display:flex;flex-wrap:wrap;justify-content:space-around}.nb-theme-cosmic   [_nghost-%COMP%]   input[_ngcontent-%COMP%]{width:20rem}[dir=ltr]   .nb-theme-cosmic   [_nghost-%COMP%]   -shadowcsshost   button[_ngcontent-%COMP%]{margin:0 .75rem 0 0}[dir=rtl]   .nb-theme-cosmic   [_nghost-%COMP%]   -shadowcsshost   button[_ngcontent-%COMP%]{margin:0 0 0 .75rem}.nb-theme-corporate   [_nghost-%COMP%]   button[nbButton][_ngcontent-%COMP%]{margin:.25rem}.nb-theme-corporate   [_nghost-%COMP%]   .container[_ngcontent-%COMP%]{display:-webkit-box;display:flex;flex-wrap:wrap;justify-content:space-around}.nb-theme-corporate   [_nghost-%COMP%]   input[_ngcontent-%COMP%]{width:20rem}[dir=ltr]   .nb-theme-corporate   [_nghost-%COMP%]   -shadowcsshost   button[_ngcontent-%COMP%]{margin:0 .75rem 0 0}[dir=rtl]   .nb-theme-corporate   [_nghost-%COMP%]   -shadowcsshost   button[_ngcontent-%COMP%]{margin:0 0 0 .75rem}"]}),e})();var C=n("pfsP");const v=[{path:"",component:l,children:[{path:"edit/:id",canActivate:[C.a],component:w},{path:"current",component:w},{path:"add",canActivate:[C.a],component:w}]}];let P=(()=>{class e{}return e.\u0275mod=a["\u0275\u0275defineNgModule"]({type:e}),e.\u0275inj=a["\u0275\u0275defineInjector"]({factory:function(t){return new(t||e)},imports:[[s.g.forChild(v)],s.g]}),e})();var _=n("gcnP"),O=n("h+2I");n.d(t,"UsersModule",(function(){return x}));const E=[b.j,b.n,b.D,b.cb,b.Zb,b.uc,b.zb,b.Ib,b.mb,b.Z,b.Qb,b.Q,b.cb];let x=(()=>{class e{}return e.\u0275mod=a["\u0275\u0275defineNgModule"]({type:e}),e.\u0275inj=a["\u0275\u0275defineInjector"]({factory:function(t){return new(t||e)},providers:[],imports:[[i.a,_.AuthModule,o.d,P,O.a,r.u,...E]]}),e})()}}]);